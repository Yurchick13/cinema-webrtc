<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LordFilm ¬∑ Cinema Party</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            background: #0a0c0e;
            color: white;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        #video-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #000;
            position: relative;
        }
        iframe, video {
            width: 100%;
            height: 100%;
            border: none;
            background: #000;
        }
        #info {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(0,0,0,0.85);
            padding: 12px 24px;
            border-radius: 40px;
            z-index: 1000;
            border: 1px solid #ff4d4d;
            color: #ff4d4d;
            font-weight: bold;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        #status {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.85);
            padding: 12px 24px;
            border-radius: 40px;
            z-index: 1000;
            border: 1px solid #00ff88;
            color: #00ff88;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        #debug {
            position: fixed;
            bottom: 20px;
            left: 20px;
            right: 20px;
            background: rgba(0,0,0,0.9);
            color: #ffaa00;
            padding: 15px;
            border-radius: 10px;
            font-family: monospace;
            font-size: 12px;
            z-index: 1001;
            border: 1px solid #ffaa00;
            display: none;
            max-height: 200px;
            overflow: auto;
            white-space: pre-wrap;
            word-break: break-all;
        }
        .btn {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: #ff4d4d;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(255,75,75,0.3);
            display: none;
        }
        .btn:hover {
            background: #ff3333;
            transform: translateX(-50%) scale(1.05);
        }
        @media (max-width: 768px) {
            #info, #status {
                font-size: 12px;
                padding: 8px 16px;
            }
        }
    </style>
</head>
<body>
    <div id="info">üé¨ LordFilm | –ö–æ–º–Ω–∞—Ç–∞: <span id="room-id">–∑–∞–≥—Ä—É–∑–∫–∞...</span></div>
    <div id="status">üü° –ó–∞–≥—Ä—É–∑–∫–∞ –ø–ª–µ–µ—Ä–∞...</div>
    <div id="debug"></div>
    <button id="back-btn" class="btn" onclick="window.history.back()">‚óÄ –ù–∞–∑–∞–¥</button>
    
    <div id="video-container">
        <video id="player" controls autoplay style="display: none;"></video>
        <iframe id="player-iframe" allowfullscreen allow="autoplay; fullscreen" style="display: none;"></iframe>
    </div>

    <script>
        // ============ –ü–û–õ–£–ß–ê–ï–ú –ü–ê–†–ê–ú–ï–¢–†–´ ============
        const urlParams = new URLSearchParams(window.location.search);
        const roomId = urlParams.get('room') || 'default';
        const videoUrl = urlParams.get('url');
        
        document.getElementById('room-id').textContent = roomId;
        
        // ============ –§–£–ù–ö–¶–ò–Ø –û–¢–õ–ê–î–ö–ò ============
        function debug(message) {
            console.log(message);
            const debugEl = document.getElementById('debug');
            debugEl.style.display = 'block';
            debugEl.innerHTML += '> ' + new Date().toLocaleTimeString() + ': ' + message + '\n';
            debugEl.scrollTop = debugEl.scrollHeight;
        }
        
        // ============ –ó–ê–ì–†–£–ó–ö–ê –í–ò–î–ï–û ============
        if (videoUrl) {
            debug('–ü–æ–ª—É—á–µ–Ω–∞ —Å—Å—ã–ª–∫–∞: ' + videoUrl);
            
            const video = document.getElementById('player');
            const iframe = document.getElementById('player-iframe');
            const status = document.getElementById('status');
            
            // ============ –ü–†–û–í–ï–†–ö–ê –¢–ò–ü–ê –°–°–´–õ–ö–ò ============
            
            // 1. –ü—Ä—è–º—ã–µ .mp4 –ø–æ—Ç–æ–∫–∏ —Å api.atomics.ws (–ò–î–ï–ê–õ–¨–ù–û!)
            if (videoUrl.includes('api.atomics.ws') || videoUrl.includes('.mp4') || videoUrl.includes('.m3u8')) {
                debug('‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –≤–∏–¥–µ–æ');
                video.style.display = 'block';
                iframe.style.display = 'none';
                video.src = videoUrl;
                video.play().catch(e => debug('–û—à–∏–±–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞: ' + e));
                status.innerHTML = 'üé¨ –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ .mp4';
                status.style.borderColor = '#00ff88';
                status.style.color = '#00ff88';
            }
            
            // 2. –°—Å—ã–ª–∫–∏ –Ω–∞ svetacdn.in (—Ç–æ–∂–µ –ø—Ä—è–º—ã–µ .mp4)
            else if (videoUrl.includes('svetacdn.in')) {
                debug('‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω –ø–æ—Ç–æ–∫ svetacdn');
                video.style.display = 'block';
                iframe.style.display = 'none';
                video.src = videoUrl;
                video.play().catch(e => debug('–û—à–∏–±–∫–∞
